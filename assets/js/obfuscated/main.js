const API_BASE_URL = atob('L2FwaQ=='); const DEBOUNCE_DELAY = 300; const MAX_SEARCH_RESULTS = 7; const REQUEST_TIMEOUT = 15000; let storageManager, uiComponents; const AppState = {isLoading: false, currentPage: null, searchResults: [], lastSearchQuery: '', readingHistory: JSON.parse(localStorage.getItem(atob('cmVhZGluZ0hpc3Rvcnk=')) || '[]'), userPreferences: JSON.parse(localStorage.getItem(atob('dXNlclByZWZlcmVuY2Vz')) || '{}') }; function debounce(func, delay) {let timeoutId; return function (...args) {clearTimeout(timeoutId); timeoutId = setTimeout(() => func.apply(this, args), delay);};}function showLoadingState(container, message = atob('TG9hZGluZy4uLg==')) {if (!container) return; container.innerHTML = ` <div class=atob(atob('Ykc5aFpHbHVaeTFqYjI1MFlXbHVaWEk9'))> <div class=atob(atob('Ykc5aFpHbHVaeTF6Y0dsdWJtVnk='))></div> <p class=atob(atob('Ykc5aFpHbHVaeTF0WlhOellXZGw='))>${message}</p> </div> `;}function showErrorState(container, message, retry = false) {if (!container) return; const retryButton = retry ? atob('PGJ1dHRvbiBjbGFzcz1hdG9iKA==')cmV0cnktYnRuatob('KSBvbmNsaWNrPWF0b2Io')bG9jYXRpb24ucmVsb2FkKCk=atob('KT5SZXRyeTwvYnV0dG9uPg==') : ''; container.innerHTML = ` <div class=atob(atob('WlhKeWIzSXRZMjl1ZEdGcGJtVnk='))> <div class=atob(atob('WlhKeWIzSXRhV052Ymc9PQ=='))>‚ö†Ô∏è</div> <p class=atob(atob('WlhKeWIzSXRiV1Z6YzJGblpRPT0='))>${message}</p> ${retryButton}</div> `;}function showEmptyState(container, message = atob('Tm8gY29udGVudCBmb3VuZC4=')) {if (!container) return; container.innerHTML = ` <div class=atob(atob('Wlcxd2RIa3RZMjl1ZEdGcGJtVnk='))> <div class=atob(atob('Wlcxd2RIa3RhV052Ymc9PQ=='))>üìö</div> <p class=atob(atob('Wlcxd2RIa3RiV1Z6YzJGblpRPT0='))>${message}</p> </div> `;}async function makeApiRequest(url, options = {}) {console.log(atob('TWFraW5nIEFQSSByZXF1ZXN0IHRvOg=='), url); const controller = new AbortController(); const timeoutId = setTimeout(() => controller.abort(), REQUEST_TIMEOUT); try {const response = await fetch(url, {...options, signal: controller.signal }); clearTimeout(timeoutId); console.log(atob('UmVzcG9uc2Ugc3RhdHVzOg=='), response.status); console.log(atob('UmVzcG9uc2Ugb2s6'), response.ok); if (!response.ok) {throw new Error(`HTTP ${response.status}: ${response.statusText}`);}const data = await response.json(); console.log(atob('UmVzcG9uc2UgZGF0YTo='), data); if (!data.success) {throw new Error(data.error || atob('QVBJIHJlcXVlc3QgZmFpbGVk'));}return data;}catch (error) {clearTimeout(timeoutId); if (error.name === atob('QWJvcnRFcnJvcg==')) {throw new Error(atob('UmVxdWVzdCB0aW1lZCBvdXQuIFBsZWFzZSB0cnkgYWdhaW4u'));}console.error(atob('QVBJIHJlcXVlc3QgZmFpbGVkOg=='), error); throw error;}}function createMangaCard(manga) {const cardLink = document.createElement('a'); cardLink.href = `detail.html?url=${encodeURIComponent(manga.detail_url)}`; cardLink.className = atob('bWFuaHdhLWNhcmQ='); cardLink.setAttribute(atob('ZGF0YS10aXRsZQ=='), manga.title); const isBookmarked = (storageManager && storageManager.isBookmarked) ? storageManager.isBookmarked(manga.title) : false; cardLink.innerHTML = ` <div class=atob(atob('WTJGeVpDMXBiV0ZuWlE9PQ=='))> <img src=atob(atob('Skh0dFlXNW5ZUzVqYjNabGNsOTFjbXg5')) alt=atob(atob('Skh0dFlXNW5ZUzUwYVhSc1pYMD0=')) loading=atob(atob('YkdGNmVRPT0=')) onerror=atob(atob('ZEdocGN5NXpkSGxzWlM1a2FYTndiR0Y1UFNkdWIyNWxKenNnZEdocGN5NXVaWGgwUld4bGJXVnVkRk5wWW14cGJtY3VjM1I1YkdVdVpHbHpjR3hoZVQwblpteGxlQ2M9')) > <div class=atob(atob('YVcxaFoyVXRjR3hoWTJWb2IyeGtaWEk9')) style=atob(atob('WkdsemNHeGhlVG9nYm05dVpUcz0='))> <span>üìñ</span> </div> <div class=atob(atob('WTJGeVpDMXZkbVZ5YkdGNQ=='))> <button class=atob(atob('Y21WaFpDMWlkRzQ9')) aria-label=atob(atob('Vm1sbGR5QmtaWFJoYVd4eklHWnZjaUFrZTIxaGJtZGhMblJwZEd4bGZRPT0='))> View Details </button> </div> <div class=atob(atob('WW05dmEyMWhjbXN0WTI5dWRHRnBibVZ5'))> <button class=atob(atob('WW05dmEyMWhjbXN0WW5SdUlDUjdhWE5DYjI5cmJXRnlhMlZrSUQ4Z0oySnZiMnR0WVhKclpXUW5JRG9nSnlkOQ==')) data-manga=atob('JHtKU09OLnN0cmluZ2lmeShtYW5nYSl9') onclick=atob(atob('WlhabGJuUXVjSEpsZG1WdWRFUmxabUYxYkhRb0tUc2daWFpsYm5RdWMzUnZjRkJ5YjNCaFoyRjBhVzl1S0NrN0lIUnZaMmRzWlVKdmIydHRZWEpyS0hSb2FYTXA='))> <svg class=atob(atob('WW05dmEyMWhjbXN0YVdOdmJnPT0=')) width="20" height="20" viewBox=atob(atob('TUNBd0lESTBJREkw')) fill=atob(atob('Ym05dVpRPT0=')) stroke=atob(atob('WTNWeWNtVnVkRU52Ykc5eQ==')) stroke-width="2"> <path d=atob(atob('VFRFNUlESXhiQzAzTFRVdE55QTFWalZoTWlBeUlEQWdNQ0F4SURJdE1tZ3hNR0V5SURJZ01DQXdJREVnTWlBeWVnPT0='))></path> </svg> <span class=atob(atob('WW05dmEyMWhjbXN0ZEdWNGRBPT0='))>${isBookmarked ? atob('Qm9va21hcmtlZA==') : atob('Qm9va21hcms=')}</span> </button> </div> </div> <div class=atob(atob('WTJGeVpDMWpiMjUwWlc1MA=='))> <h3 class=atob(atob('WTJGeVpDMTBhWFJzWlE9PQ==')) title=atob(atob('Skh0dFlXNW5ZUzUwYVhSc1pYMD0='))>${manga.title}</h3> <p class=atob(atob('WTJGeVpDMWphR0Z3ZEdWeQ=='))>${manga.latest_chapter || 'N/A'}</p> </div> `; return cardLink;}function createSearchResultItem(manga) {const item = document.createElement('a'); item.href = `detail.html?url=${encodeURIComponent(manga.detail_url)}`; item.className = atob('c2VhcmNoLXJlc3VsdC1pdGVt'); item.innerHTML = ` <img src=atob(atob('Skh0dFlXNW5ZUzVqYjNabGNsOTFjbXg5')) alt=atob(atob('Skh0dFlXNW5ZUzUwYVhSc1pYMD0=')) loading=atob(atob('YkdGNmVRPT0='))> <span class=atob(atob('YzJWaGNtTm9MWEpsYzNWc2RDMTBhWFJzWlE9PQ=='))>${manga.title}</span> `; return item;}function displayMangaGrid(container, mangaList) {if (!container) return; if (!mangaList || mangaList.length === 0) {showEmptyState(container, atob('Tm8gbWFuZ2EgZm91bmQu')); return;}container.innerHTML = mangaList.map(manga => createEnhancedMangaCard(manga)).join('');}function displaySearchResults(container, results) {if (!container) return; container.innerHTML = ''; if (!results || results.length === 0) {container.innerHTML = atob('PHAgY2xhc3M9YXRvYig=')bm8tcmVzdWx0cw==atob('KT5ObyByZXN1bHRzIGZvdW5kLjwvcD4='); return;}results.slice(0, MAX_SEARCH_RESULTS).forEach(manga => {const item = createSearchResultItem(manga); container.appendChild(item);});}async function loadAndDisplayManga(apiUrl, gridSelector, pageTitle) {const grid = document.querySelector(gridSelector); const pageTitleElement = document.getElementById(atob('cGFnZS10aXRsZQ==')); if (pageTitleElement && pageTitle) {pageTitleElement.textContent = pageTitle;}if (!grid) {console.error(`Grid container not found: ${gridSelector}`); return;}showLoadingState(grid, atob('TG9hZGluZyBtYW5nYS4uLg==')); try {const result = await makeApiRequest(apiUrl); displayMangaGrid(grid, result.data);}catch (error) {console.error(atob('RXJyb3IgbG9hZGluZyBtYW5nYTo='), error); showErrorState(grid, `Failed to load manga: ${error.message}`, true);}}async function loadHomepageContent() {const trendingGrid = document.querySelector(atob('LnRyZW5kaW5nLWdyaWQ=')); const updatesGrid = document.querySelector(atob('LnVwZGF0ZXMtZ3JpZA==')); console.log(atob('SG9tZXBhZ2UgY29udGVudCBsb2FkaW5nLi4u')); console.log(atob('VHJlbmRpbmcgZ3JpZCBmb3VuZDo='), !!trendingGrid); console.log(atob('VXBkYXRlcyBncmlkIGZvdW5kOg=='), !!updatesGrid); if (!trendingGrid && !updatesGrid) {console.error(atob('SG9tZXBhZ2UgZ3JpZCBjb250YWluZXJzIG5vdCBmb3VuZA==')); return;}if (trendingGrid) {showLoadingState(trendingGrid, atob('TG9hZGluZyB0cmVuZGluZyBtYW5nYS4uLg=='));}if (updatesGrid) {showLoadingState(updatesGrid, atob('TG9hZGluZyBsYXRlc3QgdXBkYXRlcy4uLg=='));}try {let quickResult = null; try {console.log(atob('VHJ5aW5nIHF1aWNrLWxvYWQgZm9yIGluc3RhbnQgZGlzcGxheS4uLg==')); quickResult = await makeApiRequest(`${API_BASE_URL}/quick-load`); if (quickResult && quickResult.data && quickResult.data.length > 0) {console.log(atob('UXVpY2sgbG9hZCBzdWNjZXNzZnVsLCBkaXNwbGF5aW5nIGltbWVkaWF0ZWx5')); if (trendingGrid) {displayEnhancedMangaGrid(quickResult.data.slice(0, 6), trendingGrid);}if (updatesGrid) {displayEnhancedMangaGrid(quickResult.data.slice(0, 10), updatesGrid);}}}catch (quickError) {console.log(atob('UXVpY2sgbG9hZCBmYWlsZWQsIHByb2NlZWRpbmcgd2l0aCBmdWxsIGxvYWQ='));}console.log(atob('TG9hZGluZyBmdWxsIHBvcHVsYXIgbWFuZ2EgZGF0YS4uLg==')); let result = await makeApiRequest(`${API_BASE_URL}/unified-popular`); if (!result || !result.data || result.data.length === 0) {console.log(atob('VW5pZmllZCBwb3B1bGFyIGZhaWxlZCwgdHJ5aW5nIHJlZ3VsYXIgcG9wdWxhciBlbmRwb2ludC4uLg==')); result = await makeApiRequest(`${API_BASE_URL}/popular`);}console.log(atob('RnVsbCBBUEkgcmVzcG9uc2UgcmVjZWl2ZWQ6'), result); if (result && result.data && result.data.length > 0) {console.log(`Loaded ${result.data.length}total items`); window.allMangaData = result.data; */ function createSearchResultsContainer() {const searchContainer = document.querySelector(atob('LnNlYXJjaC1jb250YWluZXI=')); if (!searchContainer) return null; let container = document.getElementById(atob('c2VhcmNoLXJlc3VsdHMtY29udGFpbmVy')); if (!container) {container = document.createElement('div'); container.id = atob('c2VhcmNoLXJlc3VsdHMtY29udGFpbmVy'); container.className = atob('c2VhcmNoLXJlc3VsdHMtZHJvcGRvd24='); searchContainer.appendChild(container);}return container;}function hideSearchResults() {const resultsContainer = document.getElementById(atob('c2VhcmNoLXJlc3VsdHMtY29udGFpbmVy')); if (resultsContainer) {resultsContainer.style.display = atob('bm9uZQ==');}}async function loadChapterImages(chapterUrl) {try {const result = await makeApiRequest(`${API_BASE_URL}/chapter?url=${encodeURIComponent(chapterUrl)}`); return result.data;}catch (error) {console.error(atob(atob('UTJoaGNIUmxjaUJzYjJGa0lHVnljbTl5T2c9PQ==')), error); throw error;}}function initializePage() {const page = document.body.dataset.page; console.log(`Initializing page: ${page}`); AppState.currentPage = page; switch (page) {case atob('aG9tZQ=='): loadHomepageContent(); break; case atob('cG9wdWxhcg=='): loadAndDisplayManga(`${API_BASE_URL}/unified-popular`, atob('Lm1hbmh3YS1ncmlk'), atob('UG9wdWxhciBNYW5od2E=')); break; case atob('bmV3LXJlbGVhc2Vz'): loadAndDisplayManga(`${API_BASE_URL}/unified-popular`, atob('Lm1hbmh3YS1ncmlk'), atob('TmV3IFJlbGVhc2Vz')); break; case atob('bWFuZ2FsaXN0'): handleMangaListPage(); break; case atob('ZGV0YWls'): handleDetailPage(); break; case atob('cmVhZGVy'): handleReaderPage(); break; default: console.warn(`Unknown page type: ${page}`);}}function initializeEventListeners() {const searchInput = document.getElementById(atob('c2VhcmNoLWlucHV0')); if (searchInput) {searchInput.addEventListener(atob('aW5wdXQ='), debounce(handleLiveSearch, DEBOUNCE_DELAY));}const searchForm = document.getElementById(atob('c2VhcmNoLWZvcm0=')); if (searchForm) {searchForm.addEventListener(atob('c3VibWl0'), handleSearchSubmit);}document.addEventListener(atob('Y2xpY2s='), (event) => {const searchContainer = document.querySelector(atob('LnNlYXJjaC1jb250YWluZXI=')); if (searchContainer && !searchContainer.contains(event.target)) {hideSearchResults();}}); document.addEventListener(atob('dmlzaWJpbGl0eWNoYW5nZQ=='), () => {if (document.hidden) {hideSearchResults();}}); const mobileMenuToggle = document.querySelector(atob('Lm1vYmlsZS1tZW51LXRvZ2dsZQ==')); const navMenu = document.querySelector(atob('Lm5hdi1tZW51')); if (mobileMenuToggle && navMenu) {mobileMenuToggle.addEventListener(atob('Y2xpY2s='), (e) => {e.stopPropagation(); mobileMenuToggle.classList.toggle(atob('YWN0aXZl')); navMenu.classList.toggle(atob('YWN0aXZl'));}); navMenu.addEventListener(atob('Y2xpY2s='), (e) => {if (e.target.classList.contains(atob('bmF2LWxpbms='))) {mobileMenuToggle.classList.remove(atob('YWN0aXZl')); navMenu.classList.remove(atob('YWN0aXZl'));}}); document.addEventListener(atob('Y2xpY2s='), (e) => {if (!mobileMenuToggle.contains(e.target) && !navMenu.contains(e.target)) {mobileMenuToggle.classList.remove(atob('YWN0aXZl')); navMenu.classList.remove(atob('YWN0aXZl'));}});}}async function handleReaderPage() {const urlParams = new URLSearchParams(window.location.search); const chapterUrl = urlParams.get('url'); let source = urlParams.get(atob('c291cmNl')) || atob('QXN1cmFTY2Fueg=='); if (chapterUrl && chapterUrl.includes(atob('d2VidG9vbnMuY29t'))) {source = atob('V2VidG9vbnM=');}else if (chapterUrl && chapterUrl.includes(atob('YXN1cmFzY2Fuei5jb20='))) {source = atob('QXN1cmFTY2Fueg==');}const container = document.getElementById(atob('cmVhZGVyLWNvbnRlbnQ=')); const prevHeaderBtn = document.getElementById(atob('cHJldi1jaGFwdGVyLWhlYWRlcg==')); const nextHeaderBtn = document.getElementById(atob('bmV4dC1jaGFwdGVyLWhlYWRlcg==')); const prevFooterBtn = document.getElementById(atob('cHJldi1jaGFwdGVyLWZvb3Rlcg==')); const nextFooterBtn = document.getElementById(atob('bmV4dC1jaGFwdGVyLWZvb3Rlcg==')); const chapterTitle = document.getElementById(atob('cmVhZGVyLXRpdGxl')); const endOfChapterNav = document.getElementById(atob('ZW5kLW9mLWNoYXB0ZXItbmF2')); if (!chapterUrl) {showErrorState(container, atob('Tm8gY2hhcHRlciBVUkwgcHJvdmlkZWQu')); return;}if (!container) {console.error(atob('UmVhZGVyIGNvbnRlbnQgY29udGFpbmVyIG5vdCBmb3VuZA==')); return;}showLoadingState(container, atob('TG9hZGluZyBjaGFwdGVyLi4u')); try {const chapterResult = await makeApiRequest(`${API_BASE_URL}/unified-chapter-data?url=${encodeURIComponent(chapterUrl)}&source=${source}`); displayChapterImages(chapterResult.image_urls, container); const mangaData = JSON.parse(sessionStorage.getItem(atob('Y3VycmVudF9tYW5nYQ==')) || '{}'); if (mangaData.title) {saveReadingProgress(mangaData, chapterUrl, chapterTitle);}const chapterList = JSON.parse(sessionStorage.getItem(atob('Y3VycmVudF9tYW5nYV9jaGFwdGVycw==')) || '[]'); if (chapterList.length > 0) {const currentIndex = chapterList.findIndex(chapter => chapter.url === chapterUrl); if (currentIndex !== -1) {const prevChapter = currentIndex < chapterList.length - 1 ? chapterList[currentIndex + 1] : null; const nextChapter = currentIndex > 0 ? chapterList[currentIndex - 1] : null; const currentChapter = chapterList[currentIndex]; document.title = `${currentChapter.title}- ManhwaVerse`; if (chapterTitle) {chapterTitle.textContent = currentChapter.title;}updateChapterNavigation(prevHeaderBtn, nextHeaderBtn, prevChapter?.url, nextChapter?.url, source); updateChapterNavigation(prevFooterBtn, nextFooterBtn, prevChapter?.url, nextChapter?.url, source); if (endOfChapterNav) {endOfChapterNav.style.display = atob('ZmxleA==');}initReaderUI(); console.log(atob('Q2hhcHRlciBuYXZpZ2F0aW9uOg=='), {currentIndex, totalChapters: chapterList.length, prevChapter: prevChapter?.title, nextChapter: nextChapter?.title });}else {showBasicChapterInfo(chapterUrl, chapterTitle, prevHeaderBtn, nextHeaderBtn, prevFooterBtn, nextFooterBtn, endOfChapterNav);}}else {showBasicChapterInfo(chapterUrl, chapterTitle, prevHeaderBtn, nextHeaderBtn, prevFooterBtn, nextFooterBtn, endOfChapterNav);}}catch (error) {console.error(atob('RXJyb3IgbG9hZGluZyBjaGFwdGVyOg=='), error); showErrorState(container, `Failed to load chapter: ${error.message}`, true);}}function showBasicChapterInfo(chapterUrl, chapterTitle, prevHeaderBtn, nextHeaderBtn, prevFooterBtn, nextFooterBtn, endOfChapterNav) {const mangaTitle = extractMangaTitleFromUrl(chapterUrl); const chapterTitleText = extractChapterTitleFromUrl(chapterUrl); document.title = `${chapterTitleText}- ${mangaTitle}- ManhwaVerse`; if (chapterTitle) {chapterTitle.textContent = `${mangaTitle}- ${chapterTitleText}`;}updateChapterNavigation(prevHeaderBtn, nextHeaderBtn, null, null, source); updateChapterNavigation(prevFooterBtn, nextFooterBtn, null, null, source);}